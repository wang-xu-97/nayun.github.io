---
title: "bg3伤害计算"
date: 2025-11-11T10:50:08+08:00
draft: false
tags: ["resource"]
toc: true
showTableOfContents: true
---

# 基础
## 攻击骰
### 非重击命中伤害期望
伤害公式 = 伤害骰数量n * 伤害骰面数d + 伤害加值Bonus_damage(Bd)
伤害期望D<sub>p</sub> = n * (1+d)/2 + Bd
### 攻击骰1d20计算优劣势
1. 掷20-(重击减值)：必定命中且重击
1. 掷1：严重失误，必定未命中
1. 掷2\~(20-重击减值-1)：假设攻击骰掷x(2 <= x <= 20-重击减值-1)
命中条件：x + 攻击加值 >= 敌方护甲AC

#### D20掷骰结果为k的概率P<sub>k</sub>
k∈[1,20]
1. 均势: P<sub>k</sub> = 1/20
1. 优势: P<sub>(max=k)</sub> = (2k-1)/400
1. 劣势: P<sub>(min=k)</sub> = (41-2k)/400

重击命中率P<sub>h</sub> = ∑<sub>k=20-重击减值</sub><sup>20</sup>P<sub>k</sub>
大失败率P<sub>f</sub> = P<sub>k=1</sub>
非重击命中率P<sub>n</sub> = ∑<sub>k=(Ac-Bonus)</sub><sup>20-重击减值-1</sup>P<sub>k</sub>
显示命中率P<sub>show</sub> = ∑<sub>k=B=(Ac-Bonus)</sub><sup>20</sup>P<sub>k</sub>

##### 优劣势骰概率表
| 值 \( k \) | 优势概率（分数） | 优势概率（小数） | 劣势概率（分数） | 劣势概率（小数） |
|------------|---------------|---------------|---------------|---------------|
| 1          | 1/400         | 0.0025        | 39/400        | 0.0975        |
| 2          | 3/400         | 0.0075        | 37/400        | 0.0925        |
| 3          | 5/400         | 0.0125        | 35/400        | 0.0875        |
| 4          | 7/400         | 0.0175        | 33/400        | 0.0825        |
| 5          | 9/400         | 0.0225        | 31/400        | 0.0775        |
| 6          | 11/400        | 0.0275        | 29/400        | 0.0725        |
| 7          | 13/400        | 0.0325        | 27/400        | 0.0675        |
| 8          | 15/400        | 0.0375        | 25/400        | 0.0625        |
| 9          | 17/400        | 0.0425        | 23/400        | 0.0575        |
| 10         | 19/400        | 0.0475        | 21/400        | 0.0525        |
| 11         | 21/400        | 0.0525        | 19/400        | 0.0475        |
| 12         | 23/400        | 0.0575        | 17/400        | 0.0425        |
| 13         | 25/400        | 0.0625        | 15/400        | 0.0375        |
| 14         | 27/400        | 0.0675        | 13/400        | 0.0325        |
| 15         | 29/400        | 0.0725        | 11/400        | 0.0275        |
| 16         | 31/400        | 0.0775        | 9/400         | 0.0225        |
| 17         | 33/400        | 0.0825        | 7/400         | 0.0175        |
| 18         | 35/400        | 0.0875        | 5/400         | 0.0125        |
| 19         | 37/400        | 0.0925        | 3/400         | 0.0075        |
| 20         | 39/400        | 0.0975        | 1/400         | 0.0025        |

#### 攻击加值
1. 攻击属性调整值：
    1. 近战非灵巧武器 & 灵巧武器但是力量>敏捷：使用力调
    1. 灵巧武器且敏捷>力量 & 远程武器： 使用敏调
    1. 攻击骰法术：使用施法主属性调整值
1. 对应攻击属性熟练项加值（固定存在，总等级1\~4级+2，5\~8级+3，9\~12级+4）
1. 增益buff
1. 装备加值

### 攻击骰实际伤害期望
#### 无不可重击伤害期望
D<sub>exp</sub> = 非重击命中伤害期望D<sub>p</sub> * (重击命中率P<sub>h</sub> * 2 + 非重击命中率P<sub>n</sub>)
实际命中率 = (重击命中率 * 2 + 非重击命中率)
 = P<sub>h</sub> * 2 + P<sub>n</sub>
 = ∑<sub>k=20-重击减值</sub><sup>20</sup>P<sub>k</sub> * 2 + ∑<sub>k=(Ac-Bonus)</sub><sup>20-重击减值-1</sup>P<sub>k</sub>

四元函数形式，公式基于投骰方式（均势、优势、劣势）和参数：
- 非重击命中伤害期望 \(D_p\)
- 敌方护甲 AC
- 攻击加值 Bonus
- 重击减值 C

其中，令 \(B = AC - Bonus\)，表示命中所需的最小骰子值（调整前）。

***简化后的伤害期望公式***
公式假设 \(B\) 在 1 到 20 之间，如果 \(B < 1\)，则设 \(B = 1\)。

- 均势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(C+1) + \max(20-C-B, 0)}{20}
{{< /math >}}
- 优势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)(39-C) + \max(20-C-B, 0) \times (B + 18 - C)}{400}
{{< /math >}}

- 劣势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)^2 + \max(20-C-B, 0) \times (22 - B + C)}{400}
{{< /math >}}

#### 有不可重击伤害期望
固定伤害加值一般不可重击，比如力调、敏调、巨武器大师、酸戒
D<sub>exp</sub> = 可重击的非重击伤害期望D<sub>p_normal</sub> * (P<sub>h</sub> * 2 + P<sub>n</sub>) + 不可重击伤害期望D<sub>p_special</sub> * (P<sub>h</sub>  + P<sub>n</sub>)

- 均势
{{< math type="block" >}}
D_{exp} = D_{p\_normal} \times \frac{2(C+1) + \max(20-C-B, 0)}{20} + D_{p\_special} \times \frac{(C+1) + \max(20-C-B, 0)}{20}
{{< /math >}}
- 优势
{{< math type="block" >}}
D_{exp} = D_{p\_normal} \times \frac{2(1+C)(39-C) + \max(20-C-B, 0) \times (B + 18 - C)}{400} + D_{p\_special} \times \frac{(1+C)(39-C) + \max(20-C-B, 0) \times (B + 18 - C)}{400}
{{< /math >}}

- 劣势
{{< math type="block" >}}
D_{exp} = D_{p\_normal} \times \frac{2(1+C)^2 + \max(20-C-B, 0) \times (22 - B + C)}{400} + D_{p\_special} \times \frac{(1+C)^2 + \max(20-C-B, 0) \times (22 - B + C)}{400}
{{< /math >}}

## 豁免骰
### 豁免检定骰1d20计算优劣势
1. 掷20：必定豁免成功
1. 掷1：必定豁免失败
1. 掷2\~19：假设豁免检定骰掷x
    1. 豁免AC = x + 法术豁免属性 + 豁免属性熟练项加值（0-没有熟练项 或者 总等级1\~4级+2，5\~8级+3，9\~12级+4-拥有熟练项） + 装备豁免检定AC加值
    1. 豁免失败条件：豁免DC >= 豁免AC
#### 豁免DC
1. 非固定豁免DC
    豁免DC = 8 + 施法属性调整值 + 施法属性熟练项加值（固定存在，总等级1\~4级+2，5\~8级+3，9\~12级+4） + 装备法术豁免等级DC加值
1. 固定豁免DC：[捏豁免法术卷轴](/nayun.github.io/resource/bg3伤害计算/#卷轴固定豁免dc攻击加值表)

### 开卡职业豁免属性
| 开卡职业 | 力量 | 敏捷 | 体质 | 智力 | 感知 | 魅力 |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
|战士|√| |√| | | |
|野蛮人|√| |√| | | |
|游侠|√|√|| | | |
|武僧|√|√| | | | |
|游荡者| |√| |√| | |
|吟游诗人| |√| | | |√|
|圣武士| | | | |√|√|
|邪术师| | | | |√|√|
|牧师| | | | |√|√|
|术士| | |√| | |√|
|德鲁伊| | | |√|√| |
|法师| | | |√|√| |

## 豁免骰实际伤害期望
豁免成功率 * 豁免成功伤害期望 + 豁免失败率 * 豁免失败伤害期望
### 豁免成功率
## 卷轴固定豁免DC、攻击加值表
| 法术环阶 | 豁免DC | 攻击加值 |
| :--- | :---: | :---: |
| 戏法 | 13 | +5 |
| 1环 | 13 | +5 |
| 2环 | 13 | +5 |
| 3环 | 15 | +7 |
| 4环 | 15 | +7 |
| 5环 | 17 | +9 |
| 6环 | 17 | +9 |



# 技能伤害期望
- 敌方AC=15
- 重击减值C=0
- 力调=3，等级=4（熟练项加值=2） -> 攻击加值Bonus = 5
D20掷骰结果为k的概率P<sub>k</sub>, k∈[1,20]
1. 均势: P<sub>k</sub> = 1/20
1. 优势: P<sub>(max=k)</sub> = (2k-1)/400
1. 劣势: P<sub>(min=k)</sub> = (41-2k)/400

## 巨武器大师
攻击减值 = 5
不能重击的伤害加值 = 10
### 关闭巨武器大师
1. 均势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(C+1) + \max(20-C-B, 0)}{20}
{{< /math >}}
2. 优势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)(39-C) + \max(20-C-B, 0) \times (B + 18 - C)}{400}
{{< /math >}}
3. 劣势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)^2 + \max(20-C-B, 0) \times (22 - B + C)}{400}
{{< /math >}}
### 打开巨武器大师
B<sub>2</sub> = B + 5
D<sub>p2</sub> = D<sub>p</sub> + 10
1. 均势
{{< math type="block" >}}
D_{exp} = D_{p2} \times \frac{2(C+1) + \max(20-C-B_2, 0)}{20}
{{< /math >}}
2. 优势
{{< math type="block" >}}
D_{exp} = D_{p2} \times \frac{2(1+C)(39-C) + \max(20-C-B_2, 0) \times (B_2 + 18 - C)}{400}
{{< /math >}}
3. 劣势
{{< math type="block" >}}
D_{exp} = D_{p2} \times \frac{2(1+C)^2 + \max(20-C-B_2, 0) \times (22 - B_2 + C)}{400}
{{< /math >}}

## 凶蛮打手
1. 均势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(C+1) + \max(20-C-B, 0)}{20}
{{< /math >}}
2. 优势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)(39-C) + \max(20-C-B, 0) \times (B + 18 - C)}{400}
{{< /math >}}
3. 劣势
{{< math type="block" >}}
D_{exp} = D_p \times \frac{2(1+C)^2 + \max(20-C-B, 0) \times (22 - B + C)}{400}
{{< /math >}}
实际命中率相同，非重击预期伤害不同
### 无凶蛮打手