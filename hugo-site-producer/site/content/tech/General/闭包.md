---
title: "闭包"
date: 2025-07-14T11:35:25+08:00
draft: false
tags: ["技", '编程思想', 'python', 'golang']
categories: ["tech"]
toc: true
showTableOfContents: true
---


在创建时封装当时状态，并使当时的状态生存周期延长至与闭包生存周期一致
闭包思想产物：
    1. python装饰器
    2. 回调函数
    3. 函数工厂
    4. 惰性求值
    ...

# 典型用法
## 1. python装饰器
```python
def execute(f):
    f()

@execute
def execute_when_defined():
    print('executed')

```
## 2. 函数工厂
1. 保存调用函数工厂时的参数
2. 调用生成的函数时，使用函数工厂创建函数时的参数上下文
### 示例
1. python api函数工厂
```python
def get_table_grids_wp(cli:Client, docid):
    def func(tableid):
        return [c['children'][0] for c in cli.fetchblocks(docid, tableid)['data']['items']]
    return func

get_table_grids = get_table_grids_wp(cli, docid)
get_table_grids(tid)
```
2. go 基础函数工厂
```go
package main

import "fmt"

// 函数工厂：返回一个加法函数
func makeAdder(addend int) func(int) int {
    return func(x int) int {
        return x + addend
    }
}

func main() {
    add5 := makeAdder(5)  // 创建一个加5的函数
    add10 := makeAdder(10) // 创建一个加10的函数
    
    fmt.Println(add5(3))   // 输出: 8 (3 + 5)
    fmt.Println(add10(3))  // 输出: 13 (3 + 10)
}
```