---
title: "时间字符串"
date: 2025-07-31T15:44:35+08:00
draft: false
tags: ["技", 'code', 'python', "字符"]
toc: true
showTableOfContents: true
---

## 1. datetime系列
一般来说用`from datetime import datetime`
### 1. `.fromtimestamp` 
接收一个浮点ts参数，返回datetime结构体，可接续使用datetime内置方法
经典场景：ts -> 格式化timestr
`datetime.fromtimestamp(ts).strftime('%Y-%m-%d-%H:%M:%S')`
```python
def ts2timestr(ts:float) -> str:
    return datetime.fromtimestamp(ts).strftime('%Y-%m-%d-%H:%M:%S')
```
### 2. `.strptime`
接收1. 格式化timestr, 2. 格式format；返回datetime结构体(接续使用其他内置方法)
经典场景：格式化timestr -> ts
`datetime.strptime(timestr, pattern).timestamp()`
```python 
def timestr2ts(timestr, pattern='%Y-%m-%d %H:%M:%S'):
    return datetime.strptime(timestr, pattern).timestamp()
```
### 3. `.replace`
1. python hint
```python
(method) def replace(
    year: SupportsIndex = ...,
    month: SupportsIndex = ...,
    day: SupportsIndex = ...,
    hour: SupportsIndex = ...,
    minute: SupportsIndex = ...,
    second: SupportsIndex = ...,
    microsecond: SupportsIndex = ...,
    tzinfo: _TzInfo | None = ...,
    *,
    fold: int = ...
) -> datetime
```
一般使用关键字参数指定参数传参：
`.replace(hour=23, minute=59, second=59, microsecond=0)`

2. 使用场景：
    1. 获取当天的23:59:59的timestamp值
    2. 进阶：获取任意一天的末尾（23:59:59）ts值。使用`datetime.timedelta`对象控制天数
```python 
def get_end_of_day(base=datetime.now(), delta=timedelta(days=0)):
    return (base + delta).replace(hour=23, minute=59, second=59, microsecond=0).timestamp()
```
